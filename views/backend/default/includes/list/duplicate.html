<div id="duplicate-dialog" class="modal fade">
 <div class="modal-dialog">
  <div class="modal-content">
   <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal">×</button>
    <h4>
     <i class="fa fa-language"></i>
     @lang('admin.label.pick_language', 'Dil Seç')
    </h4>
   </div>
   <form id="duplicate-form" method="post" action="{{ $url or url($prefix . 'content/duplicate') }}">
    <input id="duplicate-ids" type="hidden" name="duplicate-ids" value="">
    <div class="modal-body">
     <div class="form-group">
      <label>@lang('admin.label.language_to_duplicate', 'Çoklanacak Dil')</label>
      <select id="duplicate-language" name="duplicate-language" class="form-control select2">
       @foreach (langs() as $code => $lang)
       <option value="{{ $code }}"{{ $code == lang() ? ' selected="selected"' : '' }}>{{{ $lang }}}</option>
       @endforeach
      </select>
     </div>
    </div>
    <div class="modal-footer">
     <button type="submit" class="btn btn-sm btn-info">
      <i class="fa fa-save"></i>
      @lang('admin.button.duplicate', 'Çokla')
     </button>
     <button type="button" class="btn btn-sm btn-danger" data-dismiss="modal">
      <i class="fa fa-close"></i>
      @lang('admin.button.close', 'Kapat')
     </button>
    </div>
   </form>
  </div>
 </div>
</div>

@section('script')
@parent
<script type="text/javascript">
 //<![CDATA[
 $(function() {
  'use strict';

  $('a[href="#duplicate"]').click(function() {
   var ids = [];

   if ($(this).data('id')) {
    ids.push($(this).data('id'));
   } else {
    var checks = $('input[name="check[]"]:checked');

    if (checks.length > 0) {
     checks.each(function() {
      ids.push($(this).val());
     });
    } else {
     message("@lang('admin.message.check_at_least_one', 'En az bir kayıt seçmelisiniz!')");
    }
   }

   if (ids.length > 0) {
    if ($('#duplicate-language > option').length > 1) {
     $('#duplicate-ids').val(ids.join(','));
     $('#duplicate-dialog').modal();
    } else {
     message("@lang('admin.message.only_one_language_in_system', 'Sistemde zaten tek dil var!')");
    }
   }

   return false;
  });

  $('#duplicate-form').submit(function(e) {
   e.preventDefault();

   if ($('#duplicate-ids').val().length) {
    $.ajax({
     type: $('#duplicate-form').attr('method'),
     url: $('#duplicate-form').attr('action'),
     data: {
      'lang': $('#duplicate-language').val(),
      'id': $('#duplicate-ids').val()
     }
    }).done(function(result) {
     result.onAfterClose = function() {
      if (result.success) {
       $('#duplicate-dialog').modal('hide');
       window.location.href = "@url()";
      }
     };

     message(result);
    });
   }
  });
 });
//]]>
</script>
@stop